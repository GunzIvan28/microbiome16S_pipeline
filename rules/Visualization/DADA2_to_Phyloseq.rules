rule DADA2_to_Phyloseq:
    conda:
        "../../envs/R_visualization.yml"
    input:
        count_table = "DADA2/2_denoised/count_table.txt",
        Metadata_table = config["local_samples"],
        taxonomy_table = "DADA2/3_classified/{classifier}/{db_taxonomy}/dna-sequences_tax_assignments.txt",
        tax_tree = "DADA2/4_tree/tree.nwk"
    output:
        phyloseq_object = "DADA2/5_visualization/{classifier}/{db_taxonomy}/phyloseq_object"
    log:
        logging_folder + "DADA2/5_visualization/{classifier}/{db_taxonomy}/phyloseq_object.txt"
    script:
        "scripts/DADA2_to_phyloseq.R"



rule melt_Phyloseq_object:
    conda:
        "../../envs/R_visualization.yml"
    input:
        phyloseq_object = "{tool}/5_visualization/{classifier}/{db_taxonomy}/phyloseq_object"
    output:
        phyloseq_melted_table = "{tool}/5_visualization/{classifier}/{db_taxonomy}/phyloseq_melted_table.tsv"
    log:
        logging_folder + "{tool}/5_visualization/{classifier}/{db_taxonomy}/phyloseq_object.txt"
    script:
        "scripts/melt_phyloseq.R"
