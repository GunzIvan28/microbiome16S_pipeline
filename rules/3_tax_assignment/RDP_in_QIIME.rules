rule QIIME1_assign_taxonomy:
    conda:
        "../../envs/QIIME1.yml"
    input:
        "{denoiser}/2_denoised/dna-sequences.fasta",
        workflow.basedir + "/data/{tax_DB}/EzBioCloud_V3V4.fasta",
        workflow.basedir + "/data/{tax_DB}/EzBioCloud_V3V4_taxonomy.txt"
    output:
        "{denoiser}/3_classified/rdp_{tax_DB}/dna-sequences_tax_assignments.txt",
        "{denoiser}/3_classified/rdp_{tax_DB}/dna-sequences_tax_assignments.log"
    log:
        logging_folder + "{denoiser}/3_classified/rdp_{tax_DB}/dna-sequences_tax_assignments_log.txt"
    threads:
        8
    shell:
        '''
        #export RDP_JAR_PATH=$CONDA_PREFIX/bin/rdp_classifier-2.2.jar;
        #assign_path=$(which parallel_assign_taxonomy_rdp.py)
        parallel_assign_taxonomy_rdp.py \
          -i {input[0]} \
          -r {input[1]} \
          -t {input[2]} \
          -o $(dirname {output[0]}) \
          -c 0.5 \
          --rdp_max_memory 30000 \
           >> {log[0]}
        '''
