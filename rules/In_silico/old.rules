### Detect chimera in each sample
rule vsearch_chimera_detection_for_QC:
    conda:
        "../../envs/QIIME1.yml"
    input:
        "vsearch/1c_derep/{sample}_derep.fasta"
    output:
        non_chimeras = "QualityControl/vsearch_{sample}/nochimeras_min2.fasta",
        borderline = "QualityControl/vsearch_{sample}/borderline_min2.fasta",
        chimera_out = "QualityControl/vsearch_{sample}/uchimeout_min2.txt"
    shell:
        '''
        vsearch --uchime_denovo {input} \
        --abskew 2 \
        --sizein \
        --hardmask \
        --nonchimeras {output[non_chimeras]} \
        --borderline {output[borderline]} \
        --uchimeout {output[chimera_out]}
        '''
